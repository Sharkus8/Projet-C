#include <stdio.h>
#include <string.h>

#define MAX_PERSONNES 100
#define MAX_CONGES 25
#define MAX_UTILISATEURS 10
#define TAILLE_NOM 50 //j'add ça pour les char
#define TAILLE_MOT 20
#define TAILLE_POSTE 100

// Structure pour représenter une personne
struct Personne {
    int numeroIdentification;
    char nom[TAILLE_NOM];
    char prenom[TAILLE_NOM];
    struct datest date_naissance;
        //char adresse[100];
        // char email[50];
        //char telephone[15];
    struct coordonnees contact;
    char etatCivil[20];
    struct datestruct date_embauche
    char poste[TAILLE_POSTE];
    char grade[TAILLE_MOT];
    float salaire;
    int age;
    struct id_login login_emp;
    char emailpro[TAILLE_NOM];
};

// Structure pour représenter une demande de congé
struct Conge {
    int numeroIdentification;
    struct datest dateDebut;
    struct datest dateFin;
    char statut[20];
};

// Structure pour représenter un utilisateur avec ses droits
// est-ce que cette structure est remplaçable par celle de log-in ou s'agit-il de quelque chose de différent ?
struct Utilisateur {
    char nomUtilisateur[TAILLE_MOT];
    char role[20];
};

//structure du type global coordonnées
struct coordonnees
	{
		char numero[TAILLE_NOM]; //numéro est de type char pour permettre l'écriture d'un "bis" et autres particularités de ce type
		char rue[TAILLE_NOM];
		char complement1[TAILLE_NOM];
		char complement2[TAILLE_NOM];
		int code_postal;
		char ville[TAILLE_NOM];
		char pays[TAILLE_NOM];
		char adresse_mail[TAILLE_NOM];
		int telephone;
	};
	
//structure du type global date
struct datest
	{
		int jour;
		int mois;
		int annee;
	};
	
// structure du type global id_login qui permet d'unifier la structure de login 
struct id_login
	{
		char username[TAILLE_MOT];
		char motdepasse[TAILLE_MOT];
		int valdroits;
	};

// Liste des personnes
struct Personne personnes[MAX_PERSONNES];
int nombrePersonnes = 0;

// Liste des demandes de congé
struct Conge demandesConges[MAX_CONGES];
int nombreDemandesConges = 0;

// Liste des utilisateurs
// est-ce que liste des personnes et liste des utilisateurs ne sont pas un peu pareil ?
struct Utilisateur utilisateurs[MAX_UTILISATEURS];
int nombreUtilisateurs = 0;

//_________________________ déclaration des procédures et fonctions _______________________________
void saisie();
void creerFichepersonne();
void adressemail();



//___________________________________________
// fonction pour saisir une fiche de personne
//___________________________________________
void saisie() 

{
printf("Vous allez remplir une nouvelle fiche d'information. \n");
	
	// infos basiques
	printf ("Nom : ");
	scanf ("%[^/n]", nouvellePersonne.nom); //%[^/n] permet de lire les espaces d'une cdc, et n'arrête celle-ci qu'à "\n"
	printf ("Prénom : ");
	scanf ("%s", nouvellePersonne.prenom);
	printf ("Jour de naissance : ");
	scanf ("%d", &nouvellePersonne.date_naissance.jour);
	printf ("Mois de naissance (en chiffres arabes): ");
	scanf ("%d", &nouvellePersonne.date_naissance.mois);
	printf ("Année de naissance : ");
	scanf ("%d", &nouvellePersonne.date_naissance.annee);
	
	
	//coordonnées
	printf ("Coordonnées : \n");
	printf ("Adresse : ");
	printf ("Numéro de rue : ");
	scanf ("%[^/n]", nouvellePersonne.contact.numero);
	printf ("Nom de rue : ");
	scanf ("%[^/n]", nouvellePersonne.contact.rue);
	printf ("Complément d'adresse 1 : ");
	scanf ("%[^/n]", nouvellePersonne.contact.complement1); 
	printf ("Complément d'adresse 2 : ");
	scanf ("%[^/n]", nouvellePersonne.contact.complement2); 
	printf ("Code postal : ");
	scanf ("%d", &nouvellePersonne.contact.code_postal);
	printf ("Ville : ");
	scanf ("%[^/n]", nouvellePersonne.contact.ville); 
	printf ("Pays : ");
	scanf ("%[^/n]", nouvellePersonne.contact.pays); 
	printf ("Adresse mail personnelle : ");
	scanf ("%s", nouvellePersonne.contact.adresse_mail);
	printf ("Numéro de téléphone personnel : ");
	scanf ("%d", &nouvellePersonne.contact.telephone);
	printf ("Etat civil : ");
	scanf ("%[^/n]", nouvellePersonne.etatCivil);
	
	//embauche
	printf ("Jour d'embauche : ");
	scanf ("%d", &nouvellePersonne.date_embauche.jour);
	printf ("Mois d'embauche (en chiffres arabes) : ");
	scanf ("%d", &nouvellePersonne.date_embauche.mois);
	printf ("Année d'embauche : ");
	scanf ("%d", &nouvellePersonne.date_embauche.annee);
	printf ("Poste : ");
	scanf ("%[^/n]", nouvellePersonne.poste);
	printf ("Grade : ");
	scanf ("%[^/n]", nouvellePersonne.grade);
	printf ("Salaire : ");
	scanf ("%[^/n]", &nouvellePersonne.salaire);
	printf ("Service ou département : "); 
	scanf ("%[^/n]", nouvellePersonne.ser_dep);

	//email et login
	strcpy(nouvellePersonne.emailpro, adressemail(nouvellePersonne.nom, nouvellePersonne.prenom))


	//on ajoute ce remplissage au tableau personnes
	personnes[i]=nouvellePersonne
	

}

//___________________________________________
// Fonction pour créer une fiche de personne
//___________________________________________
void creerFichePersonne(char *nom, char *prenom, char *numrue, char *nomrue, char *comp1, char *comp2, char *ville, int *codepostal, char *pays, char *emailperso, int *telephone,
                         char *etatCivil, int *jnaiss, int *mnaiss, int *anaiss,  char *poste, char *grade, float salaire, int age, char *serdep, int *jemb, int *memb, int *aemb) {
FILE *fp


    if (nombrePersonnes < MAX_PERSONNES) {
        struct Personne nouvellePersonne; // à quoi sert cette ligne ?
        nouvellePersonne.numeroIdentification = nombrePersonnes + 1; // Attribution d'un numéro d'identification simple

//données personnelles
        strcpy(nouvellePersonne.nom, nom);
        strcpy(nouvellePersonne.prenom, prenom);
	nouvellePersonne.date_naissance.jour = jnaiss;
	nouvellePersonne.date_naissance.mois = mnaiss;
	nouvellePersonne.date_naissance.annee = anaiss;


//coordonnées
       	 strcpy(nouvellePersonne.contact.numero, numrue);
	 strcpy(nouvellePersonne.contact.rue, nomrue);
	 strcpy(nouvellePersonne.contact.complement1, comp1);
	 strcpy(nouvellePersonne.contact.complement2, comp2);
	 nouvellePersonne.contact.code_postal = codepostal
	 strcpy(nouvellePersonne.contact.ville, ville);
	 strcpy(nouvellePersonne.contact.pays, pays);
	 strcpy(nouvellePersonne.contact.adresse_mail, emailperso);
       	 strcpy(nouvellePersonne.contact.telephone, telephone);

//relatif au travail
        strcpy(nouvellePersonne.etatCivil, etatCivil);
        strcpy(nouvellePersonne.poste, poste);
        strcpy(nouvellePersonne.grade, grade);
        nouvellePersonne.salaire = salaire;
        nouvellePersonne.age = age;
	strcpy(nouvellePersonne.ser_dep, serdep);
     	nouvellePersonne.date_embauche.jour = jemb;
	nouvellePersonne.date_embauche.mois = memb;
	nouvellePersonne.date_embauche.annee = aemb;
	

//----------- ce que je te propose en remplacement pour cette fonction

	fp = fopen(Fichierfiches.txt, "w")

        personnes[nombrePersonnes++] = nouvellePersonne; 

	for (i=0; i<nombrePersonne; i++)
// infos basiques
	fprintf (fp, "%[^/n]", nouvellePersonne.nom); //%[^/n] permet de lire les espaces d'une cdc, et n'arrête celle-ci qu'à "\n"
	fprintf (fp, "%s", nouvellePersonne.prenom);
	fprintf (fp, "%d", &nouvellePersonne.date_naissance.jour);
	fprintf (fp, "%d", &nouvellePersonne.date_naissance.mois);
	fprintf (fp, "%d", &nouvellePersonne.date_naissance.annee);
	
	
	//coordonnées
	fprintf (fp, "%[^/n]", nouvellePersonne.contact.numero);
	fprintf (fp, "%[^/n]", nouvellePersonne.contact.rue);
	fprintf (fp, "%[^/n]", nouvellePersonne.contact.complement1); 
	fprintf (fp, "%[^/n]", nouvellePersonne.contact.complement2); 
	fprintf (fp, "%d", &nouvellePersonne.contact.code_postal);
	fprintf (fp, "%[^/n]", nouvellePersonne.contact.ville); 
	fprintf (fp, "%[^/n]", nouvellePersonne.contact.pays); 
	fprintf (fp, "%s", nouvellePersonne.contact.adresse_mail);
	fprintf (fp, "%d", &nouvellePersonne.contact.telephone);
	fprintf (fp, "%[^/n]", nouvellePersonne.etatCivil);
	
	//embauche
	fprintf (fp, "%d", &nouvellePersonne.date_embauche.jour);
	fprintf (fp, "%d", &nouvellePersonne.date_embauche.mois);
	fprintf (fp, "%d", &nouvellePersonne.date_embauche.annee);
	fprintf (fp, "%[^/n]", nouvellePersonne.poste);
	fprintf (fp, "%[^/n]", nouvellePersonne.grade);
	fprintf (fp, "%[^/n]", &nouvellePersonne.salaire);
	fprintf (fp, "%[^/n]", nouvellePersonne.ser_dep);

	fclose(Fichierfiches.txt);


        printf("Fiche de %s %s enregistrée avec succès.\n", prenom, nom);

    } else {
        printf("Limite de personnes atteinte. Impossible de créer une nouvelle fiche.\n");
    }
}




//___________________________________________
Fonction pour créer une adresse mail pro IDEM JE DOIS REMPLACER LES NOMS DE VARIABLES
//___________________________________________
char adressemail(nom[], prenom[])
{
char nom[TAILLE_NOM], prenom[TAILLE_NOM], email[TAILLE_NOM]
	strcpy(email,prenom)
	TROUVER COMMENT SUPPRIMER LES ESPACES DUN NOM COMPOSE
	strcat(email,".");
	strcat(email,nom);
	strcat(email,"@entreprise.com");

	return email;
}
